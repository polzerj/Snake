Sorry for this awful code. I developed this project after the first three months of developing
